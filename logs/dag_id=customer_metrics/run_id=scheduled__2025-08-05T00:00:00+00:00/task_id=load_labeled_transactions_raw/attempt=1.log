[2025-08-06T01:37:59.288+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_metrics.load_labeled_transactions_raw scheduled__2025-08-05T00:00:00+00:00 [queued]>
[2025-08-06T01:37:59.294+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_metrics.load_labeled_transactions_raw scheduled__2025-08-05T00:00:00+00:00 [queued]>
[2025-08-06T01:37:59.294+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-06T01:37:59.308+0000] {taskinstance.py:2214} INFO - Executing <Task(AirbyteTriggerSyncOperator): load_labeled_transactions_raw> on 2025-08-05 00:00:00+00:00
[2025-08-06T01:37:59.314+0000] {standard_task_runner.py:60} INFO - Started process 5555 to run task
[2025-08-06T01:37:59.317+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'customer_metrics', 'load_labeled_transactions_raw', 'scheduled__2025-08-05T00:00:00+00:00', '--job-id', '56', '--raw', '--subdir', 'DAGS_FOLDER/customer_metrics.py', '--cfg-path', '/tmp/tmpjsjo2c2q']
[2025-08-06T01:37:59.319+0000] {standard_task_runner.py:88} INFO - Job 56: Subtask load_labeled_transactions_raw
[2025-08-06T01:37:59.370+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_metrics.load_labeled_transactions_raw scheduled__2025-08-05T00:00:00+00:00 [running]> on host a4babef49899
[2025-08-06T01:37:59.451+0000] {taskinstance.py:2510} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='customer_metrics' AIRFLOW_CTX_TASK_ID='load_labeled_transactions_raw' AIRFLOW_CTX_EXECUTION_DATE='2025-08-05T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-08-05T00:00:00+00:00'
[2025-08-06T01:37:59.460+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:38:02.607+0000] {airbyte.py:86} INFO - Job 6 was submitted to Airbyte Server
[2025-08-06T01:38:02.607+0000] {airbyte.py:88} INFO - Waiting for job 6 to complete
[2025-08-06T01:38:05.633+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:38:11.886+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:38:39.108+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:05.159+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:08.418+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:11.471+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:14.494+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:17.530+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:20.553+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:23.576+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:26.598+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:29.624+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:32.688+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:35.926+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:38.947+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:41.966+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:44.985+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:48.018+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:51.072+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:54.161+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:39:57.267+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:40:00.526+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:40:03.802+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:40:07.401+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:40:48.597+0000] {connection.py:508} ERROR - Unable to retrieve connection from secrets backend (MetastoreBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 691, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.8/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "db" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 503, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 79, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/metastore.py", line 42, in get_connection
    return MetastoreBackend._fetch_connection(conn_id, session=session)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/api_internal/internal_api_call.py", line 114, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/metastore.py", line 73, in _fetch_connection
    conn = session.scalar(select(Connection).where(Connection.conn_id == conn_id).limit(1))
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 691, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.8/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "db" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-08-06T01:41:11.122+0000] {airbyte.py:129} INFO - Retrying. Airbyte API returned server error when waiting for job: The conn_id `airbyte` isn't defined
[2025-08-06T01:41:14.144+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:17.187+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:20.240+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:23.263+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:26.295+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:29.336+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:32.397+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:35.438+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:38.477+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:41.503+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:44.528+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:47.569+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:50.599+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:53.634+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:56.670+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:41:59.721+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:02.747+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:05.777+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:08.816+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:11.874+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:14.915+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:17.950+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:20.985+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:24.006+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:27.026+0000] {base.py:83} INFO - Using connection ID 'airbyte' for task execution.
[2025-08-06T01:42:27.039+0000] {taskinstance.py:2728} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/airbyte/operators/airbyte.py", line 111, in execute
    hook.wait_for_job(job_id=self.job_id, wait_seconds=self.wait_seconds, timeout=self.timeout)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/airbyte/hooks/airbyte.py", line 141, in wait_for_job
    raise Exception(f"Encountered unexpected state `{state}` for job_id `{job_id}`")
Exception: Encountered unexpected state `failed` for job_id `6`
[2025-08-06T01:42:27.054+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=customer_metrics, task_id=load_labeled_transactions_raw, execution_date=20250805T000000, start_date=20250806T013759, end_date=20250806T014227
[2025-08-06T01:42:27.076+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 56 for task load_labeled_transactions_raw (Encountered unexpected state `failed` for job_id `6`; 5555)
[2025-08-06T01:42:27.115+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-08-06T01:42:27.196+0000] {taskinstance.py:3309} INFO - 0 downstream tasks scheduled from follow-on schedule check
